# This file is part of the Fuzion language implementation.
#
# The Fuzion language implementation is free software: you can redistribute it
# and/or modify it under the terms of the GNU General Public License as published
# by the Free Software Foundation, version 3 of the License.
#
# The Fuzion language implementation is distributed in the hope that it will be
# useful, but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public
# License for more details.
#
# You should have received a copy of the GNU General Public License along with The
# Fuzion language implementation.  If not, see <https://www.gnu.org/licenses/>.


# -----------------------------------------------------------------------
#
#  Tokiwa Software GmbH, Germany
#
#  Source code of Fuzion standard library feature i18n.provide
#
# -----------------------------------------------------------------------

# provide -- effect that provides operations that are specific for a geographical, political,
# or cultural region. Such operations include formatting of dates,  numbers, currencies,
# etc.
#
public provide ref : effect is

    # date -- operation of the i18n.provide effect and formats a date specific to the installed location
    #
    public date(d i32, m i32, y i32) String => abstract

    # currency -- operation of the i18n.provide effect and
    # formats the currency specific to the installed location
    #
    public currency(c i32) String => abstract

    # current -- operation of the i18n.provide effect to be able to install the default effect
    public current i18n.provide ! envir.vars, i18n.provide =>
        i18n.provide.install_default
        i18n.provide.env


    public type.install_default unit ! envir.vars =>

        if !i18n.provide.is_instated
            l := envir.vars["LANG"].val ""

            p i18n.provide :=
                if l.starts_with "de"
                    i18n.german
                else if l.starts_with "jp"
                    i18n.japanese
                else if l.starts_with "en"
                    i18n.american
                else if l.starts_with "kr"
                    i18n.korean
                else
                    i18n.ISO

            i18n.provide.type.default p
