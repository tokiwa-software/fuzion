# This file is part of the Fuzion language implementation.
#
# The Fuzion language implementation is free software: you can redistribute it
# and/or modify it under the terms of the GNU General Public License as published
# by the Free Software Foundation, version 3 of the License.
#
# The Fuzion language implementation is distributed in the hope that it will be
# useful, but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public
# License for more details.
#
# You should have received a copy of the GNU General Public License along with The
# Fuzion language implementation.  If not, see <https://www.gnu.org/licenses/>.


# -----------------------------------------------------------------------
#
#  Tokiwa Software GmbH, Germany
#
#  Source code of Fuzion module tokiwa
#
# -----------------------------------------------------------------------

#
# unit feature grouping tokiwa related code
#
public tokiwa is

  #
  # send something to our influx database
  #
  # e.g. post_to_influx "tokiwa" "benchmarks" "**token**" "tests,test=hello value=26.5"
  #
  public post_to_influx(org, bucket, token, str String) outcome String =>
    web.post_r
      net.family.ipv4
      "https://influxdb.tokiwa.software:8086/api/v2/write?org={org}&bucket={bucket}&precision=s"
      str.utf8
      (container.map_of [("Authorization", "Token {token}"),
                         ("Content-Type", "text/plain")])
